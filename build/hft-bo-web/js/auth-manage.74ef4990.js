"use strict";(self["webpackChunkbo_project"]=self["webpackChunkbo_project"]||[]).push([[223],{181:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",[e("Row",{staticStyle:{margin:"10px"}},[e("Col",{staticClass:"mr3"},[e("form",{attrs:{autocomplete:"off"}},[e("Input",{staticStyle:{float:"right",width:"180px","border-radius":"20px"},attrs:{placeholder:"策略名称"},on:{"on-keydown":function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)},"on-change":t.handleSearch},model:{value:t.pagination.ruleName,callback:function(e){t.$set(t.pagination,"ruleName",e)},expression:"pagination.ruleName"}},[e("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search",size:"19"},nativeOn:{click:function(e){return t.handleSearch.apply(null,arguments)}},slot:"suffix"})],1),e("Select",{staticClass:"mr3",staticStyle:{width:"100px"},attrs:{placeholder:"审批状态",clearable:!0},model:{value:t.pagination.ruleVettingStatus,callback:function(e){t.$set(t.pagination,"ruleVettingStatus",e)},expression:"pagination.ruleVettingStatus"}},t._l(this.$store.state.dictionary.dictionaryList.RuleVettingStatus,(function(a){return e("Option",{key:a.code,attrs:{value:a.code}},[t._v(t._s(a.description)+" ")])})),1)],1)]),e("Col",{staticStyle:{position:"absolute",right:"25px"}},[e("Button",{staticClass:"mr3",attrs:{type:"primary"},on:{click:function(e){return t.refresh()}}},[e("Icon",{attrs:{type:"md-search"}}),t._v(" 查询 ")],1),e("Button",{staticClass:"mr3",attrs:{type:"success"},on:{click:()=>t.handleExport(t.URL.myVettingExport,this.pagination,"我的策略申请")}},[e("Icon",{attrs:{type:"md-download"}}),t._v(" 导出 ")],1),e("Modal",{attrs:{draggable:"",sticky:"",mask:"",width:t.chooseRule?1300:600,"mask-closable":!1,title:"编辑用户策略"},model:{value:t.showAddModal,callback:function(e){t.showAddModal=e},expression:"showAddModal"}},[e("div",{class:[t.chooseRule?"modal__content":""]},[e("div",{staticClass:"modal__content-left"},[e("Form",{ref:"ruleForm",attrs:{model:t.userStrategyInfo,"label-width":210,"label-colon":"",rules:t.userValidRules,autocomplete:"off"}},[e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略文件类型",prop:"ruleFileType"}},[e("Select",{attrs:{placeholder:"请选择策略文件类型",maxlength:32},on:{"on-change":t.fetchNewPolicyInfo},model:{value:t.userStrategyInfo.ruleFileType,callback:function(e){t.$set(t.userStrategyInfo,"ruleFileType",e)},expression:"userStrategyInfo.ruleFileType"}},t._l(t.getRuleFileType(),(function(a){return e("Option",{key:a.code,attrs:{value:a.code}},[t._v(t._s(a.description)+" ")])})),1)],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略ID",prop:"ruleId"}},[e("Input",{attrs:{disabled:"",placeholder:"请输入策略ID",maxlength:20,"show-message":"false"},model:{value:t.userStrategyInfo.ruleId,callback:function(e){t.$set(t.userStrategyInfo,"ruleId",e)},expression:"userStrategyInfo.ruleId"}})],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略文件存储位置",prop:"rulePath"}},[e("Tooltip",{staticStyle:{width:"100%"},attrs:{content:t.userStrategyInfo.rulePath,"max-width":"300"}},[e("Input",{attrs:{disabled:"",placeholder:"请输入策略文件存储位置",autocomplete:"off",maxlength:256},model:{value:t.userStrategyInfo.rulePath,callback:function(e){t.$set(t.userStrategyInfo,"rulePath",e)},expression:"userStrategyInfo.rulePath"}})],1)],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略版本",prop:"ruleVersion"}},[e("Input",{attrs:{placeholder:"请输入策略版本",autocomplete:"off",maxlength:32},model:{value:t.userStrategyInfo.ruleVersion,callback:function(e){t.$set(t.userStrategyInfo,"ruleVersion",e)},expression:"userStrategyInfo.ruleVersion"}})],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略名称",prop:"ruleName"}},[e("Input",{attrs:{placeholder:"请输入策略名称",autocomplete:"off",maxlength:32},model:{value:t.userStrategyInfo.ruleName,callback:function(e){t.$set(t.userStrategyInfo,"ruleName",e)},expression:"userStrategyInfo.ruleName"}})],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"用户代码",prop:"customerIds"}},[e("Select",{attrs:{placeholder:"请选择用户代码",maxlength:32,multiple:"",filterable:"","max-tag-count":1},model:{value:t.userStrategyInfo.customerIds,callback:function(e){t.$set(t.userStrategyInfo,"customerIds",e)},expression:"userStrategyInfo.customerIds"}},t._l(t.userList,(function(a){return e("Option",{key:a.customerId,attrs:{value:a.customerId}},[t._v(t._s(a.customerId+`(${a.customerName})`)+" ")])})),1)],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"策略类型",prop:"ruleType"}},[e("Select",{attrs:{placeholder:"请选择策略类型",maxlength:32},on:{"on-change":t.handleShowParamsTable},model:{value:t.userStrategyInfo.ruleType,callback:function(e){t.$set(t.userStrategyInfo,"ruleType",e)},expression:"userStrategyInfo.ruleType"}},t._l(t.getRuleQuantType(),(function(a){return e("Option",{key:a.code,attrs:{value:a.code}},[t._v(t._s(a.description)+" ")])})),1)],1)],1),e("Col",{attrs:{span:20}},[e("FormItem",{attrs:{label:""}},[e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"fileInput"},on:{change:function(e){return t.handleFileChange(e,t.fileType,t.URL.uploadVetting)}}}),e("Button",{directives:[{name:"show",rawName:"v-show",value:t.chooseRule,expression:"chooseRule"}],staticClass:"btn",staticStyle:{"margin-right":"5px"},attrs:{type:"success"},on:{click:function(e){return t.uploadFile("strategy")}}},[e("Icon",{attrs:{type:"md-cloud-upload"}}),t._v(" 上传策略文件 ")],1),e("Icon",{directives:[{name:"show",rawName:"v-show",value:t.uploadFlag,expression:"uploadFlag"}],attrs:{type:"ios-checkmark-circle",color:"green",size:"23"}}),e("div",[t._v(t._s(this.fileName))])],1)],1)],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.chooseRule,expression:"chooseRule"}],staticClass:"modal__content-right"},[e("Button",{staticClass:"btn",attrs:{type:"info"},on:{click:function(e){return t.uploadFile("param")}}},[t._v("导入参数")]),e("Button",{staticClass:"btn",attrs:{type:"success"},on:{click:t.addRow}},[t._v("添加参数")]),e("Button",{staticClass:"btn",attrs:{type:"error"},on:{click:t.clearParamList}},[t._v("清空列表")]),e("Button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.exportParamList}},[t._v("导出参数")]),e("ParamsTable",{attrs:{paramList:t.paramList,readOnly:!1}})],1)]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.ok()}}},[t._v("确定")])],1)])],1)],1),e("Table",{ref:"table",staticClass:"table-content",attrs:{columns:t.columns1,data:t.tableData,height:t.tableHeight,size:"small",loading:t.loading,border:""},on:{"on-sort-change":e=>t.handleSort(e,this.getMyVettingList)},scopedSlots:t._u([{key:"operator",fn:function({row:a}){return[e("div",{staticStyle:{display:"flex","justify-content":"flex-start"},on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"table-operate",on:{click:()=>t.modalUser("modify",a)}},[t._v(" 编辑 ")]),e("div",{staticClass:"table-operate",on:{click:()=>t.handleCancelVetting(a)}},[t._v(" 撤销 ")]),e("Dropdown",{attrs:{trigger:"hover",transfer:""},on:{"on-click":function(e){return t.doOperate(e,a)}},scopedSlots:t._u([{key:"list",fn:function(){return[e("DropdownMenu",[e("DropdownItem",{attrs:{name:"param"}},[t._v("策略参数")])],1)]},proxy:!0}],null,!0)},[e("a",{staticStyle:{color:"#02aff1","font-size":"14px"}},[t._v(" "+t._s("更多")+" "),e("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1)]}}])}),[e("div",{staticClass:"page-bottom"},[e("Page",{attrs:{total:t.pagination.total,current:t.pagination.pageNumber,"page-size":t.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":e=>t.handleChangePage("pageSize",e,t.getMyVettingList),"on-change":e=>t.handleChangePage("pageNumber",e,t.getMyVettingList)}})],1)]],2)},o=[],r=a(4966),n=a(913),i=a(3072),l=a(34),d=a(4266),c=a(2138),u={components:{ParamsTable:l.A},mixins:[d.M,c.b,c.Q],data(){let t={ruleVettingStatus:"",ruleName:""},e={customerIds:[]};return{pagination:t,showAddModal:!1,fileName:"",userStrategyInfo:e}},mounted(){this.getMyVettingList(),this.getUserList()},methods:{getRuleQuantType:i.Oq,doOperate(t,e){switch(t){case"param":this.paramList=JSON.parse(JSON.stringify(e.ruleParams)),this.$Modal.info({render:t=>t(l.A,{props:{paramList:this.paramList,readOnly:!0}}),width:650,okText:"确认"});break;default:}},getMyVettingList(){this.loading=!0,r.L.post(n.k.myVetting,this.pagination,this.getUserResponse)},handleSearch(){this.pagination.pageNumber=1,this.getMyVettingList()},modalUser(t,e){this.$refs.ruleForm.resetFields(),this.paramList=[],this.uploadFlag=!1,this.chooseRule="8"===e.ruleType,this.showAddModal=!0,this.paramList=JSON.parse(JSON.stringify(e.ruleParams)),this.paramList.forEach((t=>t.readOnly=String(t.readOnly))),this.userStrategyInfo.customerIds=e.customers.map((t=>t.customerId)),Object.assign(this.userStrategyInfo,e)},ok(){const t=this.checkDuplicateNames(this.paramList);if(t.length>0){const e=t.map((({name:t,count:e})=>`${t} 有${e}条`)),a=`参数名重复：${e.join("、")}`;this.showMessage(a,"error",6)}else{if(this.userStrategyInfo.ruleParams=this.paramList,!this.userStrategyInfo.rulePath)return void this.$Message.warning("策略存储路径不能为空");r.L.post(n.k.updateVetting,{...this.userStrategyInfo,messageType:"修改成功"},(t=>{"0"===t.code&&(this.getMyVettingList(),this.cancel())}))}},handleCancelVetting(t){let e=t.ruleId;r.L.post(`${n.k.cancelVetting}`,{ruleId:e,messageType:"撤销成功"},this.getMyVettingList)},refresh(){this.getMyVettingList(),this.getUserList()}}},p=u,m=a(1656),h=(0,m.A)(p,s,o,!1,null,"32dc8c84",null),g=h.exports},2027:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",[e("Row",{staticStyle:{margin:"10px"}},[e("Col",{staticClass:"mr3"},[e("form",{attrs:{autocomplete:"off"}},[e("Input",{staticStyle:{float:"right",width:"180px","border-radius":"20px"},attrs:{placeholder:"策略名称"},on:{"on-keydown":function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getVettingList.apply(null,arguments)},"on-change":t.getVettingList},model:{value:t.pagination.ruleName,callback:function(e){t.$set(t.pagination,"ruleName",e)},expression:"pagination.ruleName"}},[e("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search",size:"19"},nativeOn:{click:function(e){return t.getVettingList.apply(null,arguments)}},slot:"suffix"})],1),e("Select",{staticClass:"mr3",staticStyle:{width:"100px"},attrs:{placeholder:"审批状态",clearable:!0},model:{value:t.pagination.ruleVettingStatus,callback:function(e){t.$set(t.pagination,"ruleVettingStatus",e)},expression:"pagination.ruleVettingStatus"}},t._l(this.$store.state.dictionary.dictionaryList.RuleVettingStatus,(function(a){return e("Option",{key:a.code,attrs:{value:a.code}},[t._v(t._s(a.description)+" ")])})),1)],1)]),e("Col",{staticStyle:{position:"absolute",right:"25px"}},[e("Button",{staticClass:"mr3",attrs:{type:"primary"},on:{click:t.getVettingList}},[e("Icon",{attrs:{type:"md-search"}}),t._v(" 查询 ")],1),e("Button",{staticClass:"mr3",attrs:{type:"success"},on:{click:()=>t.handleExport(t.URL.vettingExport,this.pagination,"策略审批")}},[e("Icon",{attrs:{type:"md-download"}}),t._v(" 导出 ")],1)],1)],1),e("Table",{ref:"table",staticClass:"table-content",attrs:{columns:t.columns1,data:t.tableData,size:"small",height:t.tableHeight,loading:t.loading,border:""},on:{"on-sort-change":e=>t.handleSort(e,this.getVettingList)},scopedSlots:t._u([{key:"operator",fn:function({row:a}){return[e("div",{staticStyle:{display:"flex","justify-content":"flex-start"},on:{click:function(t){t.stopPropagation()}}},[e("div",{class:"3"===a.ruleVettingStatus||"4"===a.ruleVettingStatus||"2"===a.ruleVettingStatus?"table-operate-disabled":"table-operate",on:{click:()=>t.handleRuleApproval(a,!0)}},[t._v(" 通过 ")]),e("div",{class:"3"===a.ruleVettingStatus||"4"===a.ruleVettingStatus||"2"===a.ruleVettingStatus?"table-operate-disabled":"table-operate",on:{click:()=>t.handleRuleApproval(a,!1)}},[t._v(" 拒绝 ")]),e("Dropdown",{attrs:{trigger:"hover",transfer:""},on:{"on-click":function(e){return t.doOperate(e,a)}},scopedSlots:t._u([{key:"list",fn:function(){return[e("DropdownMenu",[e("DropdownItem",{attrs:{name:"param"}},[t._v("策略参数")]),e("DropdownItem",{attrs:{name:"down"}},[t._v("下载")])],1)]},proxy:!0}],null,!0)},[e("a",{staticStyle:{color:"#02aff1","font-size":"14px"}},[t._v(" "+t._s("更多")+" "),e("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1)]}}])}),[e("div",{staticClass:"page-bottom"},[e("Page",{attrs:{total:t.pagination.total,current:t.pagination.pageNumber,"page-size":t.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":e=>t.handleChangePage("pageSize",e,t.getVettingList),"on-change":e=>t.handleChangePage("pageNumber",e,t.getVettingList)}})],1)]],2)},o=[],r=a(4966),n=a(913),i=a(3072);function l(t,e,a){return new Promise(((s,o)=>{r.L.post(t,e,(t=>{const e=new Blob([t],{type:"application/zip"}),o=document.createElement("a");o.href=window.URL.createObjectURL(e);const r=i.kB.dateToLocaleObject(new Date),n=`${r.year}-${r.month}-${r.date}`;o.download=`${a}_${n}.zip`,document.body.appendChild(o),o.click(),document.body.removeChild(o),s()}))}))}var d=a(34),c=a(4266),u=(a(2138),{mixins:[c.M],data(){let t={ruleVettingStatus:"",ruleName:""},e=[{title:"策略ID",key:"ruleId",minWidth:120,resizable:!0,sortable:"custom",width:null},{title:"策略文件类型",key:"ruleFileType",minWidth:140,resizable:!0,width:null,sortable:"custom",render:(t,{row:e})=>{const a=(0,i.$O)(e.ruleFileType,!0);return t("span",a.description)}},{title:"策略文件存储位置",key:"rulePath",sortable:"custom",resizable:!0,width:null,minWidth:220},{title:"策略版本",key:"ruleVersion",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略名称",key:"ruleName",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"申请人",key:"submissionName",sortable:"custom",resizable:!0,width:null,minWidth:170},{title:"申请时间",key:"submissionTime",sortable:"custom",resizable:!0,width:null,minWidth:170},{title:"审批人",key:"approvalName",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"审批时间",key:"approvalTime",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略状态",key:"ruleVettingStatus",resizable:!0,width:null,minWidth:120,sortable:"custom",render:(t,e)=>{const a=["#dcba0e","#19be6b","#ed4014","#616261"],s=(0,i.a9)(e.row.ruleVettingStatus),o=e=>t("Icon",{props:{type:"ios-radio-button-on",color:a[e]}});return t("span",[o(s.code-1),s.description])}},{title:"备注",key:"comment",sortable:"custom",resizable:!0,width:null,minWidth:180},{title:"操作",slot:"operator",width:180}];return{pagination:t,columns1:e,comment:""}},mounted(){this.loading=!1,this.getVettingList()},methods:{handleExport:i.D9,handleSort:i.VB,doOperate(t,e){switch(t){case"param":this.paramList=JSON.parse(JSON.stringify(e.ruleParams)),this.$Modal.info({render:t=>t(d.A,{props:{paramList:this.paramList,readOnly:!0}}),width:650,okText:"确认"});break;case"down":this.downloadRuleApproval(e);break;default:}},getVettingList(){this.loading=!0,r.L.post(`${n.k.vetting}`,this.pagination,(t=>{this.loading=!1,this.pagination.total=t.data.total,this.tableData=t.data.dataList||[]}))},handleRuleApproval(t,e){const{ruleId:a}=t,s=e?"通过":"拒绝",o=e?n.k.agreeVetting:n.k.refuseVetting;this.$Modal.confirm({title:`确认${s}审批吗？`,render:t=>t("div",[t("Input",{props:{model:this.comment,autofocus:!0,type:"textarea",placeholder:"请输入备注",rows:4},on:{input:t=>{this.comment=t}}})]),onOk:()=>{r.L.post(o,{ruleId:a,messageType:"审批"+s,comment:this.comment},(()=>{this.getVettingList()}))},onCancel:()=>{this.comment=""},okText:"确认",cancelText:"取消"})},downloadRuleApproval(t){const{ruleId:e}=t,a={ruleId:e,messageType:"下载成功",responseType:"blob"};l(n.k.vettingDownload,a,"审批文件")}}}),p=u,m=a(1656),h=(0,m.A)(p,s,o,!1,null,"16baa69b",null),g=h.exports},4456:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",[e("Row",{staticStyle:{margin:"10px"}},[e("Col",{staticStyle:{height:"30px"}},[e("form",{attrs:{autocomplete:"off"}},[e("Input",{staticStyle:{float:"right",width:"160px","border-radius":"20px"},attrs:{placeholder:"管理员名称"},on:{"on-keydown":function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)},"on-change":t.handleSearch},model:{value:t.pagination.managerName,callback:function(e){t.$set(t.pagination,"managerName",e)},expression:"pagination.managerName"}},[e("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search",size:"19"},on:{click:t.handleSearch},slot:"suffix"})],1)],1)]),e("Col",{staticStyle:{position:"absolute",right:"25px"}},[e("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info"},on:{click:function(e){return t.modalUser("new")}}},[e("Icon",{attrs:{type:"md-add"}}),t._v(" 新增权限 ")],1),e("Button",{staticClass:"mr3",attrs:{type:"success"},on:{click:()=>t.handleExport(t.URL.tradeDataExport,this.pagination,"权限管理")}},[e("Icon",{attrs:{type:"md-download"}}),t._v(" 导出 ")],1),e("Modal",{attrs:{draggable:"",sticky:"",mask:"",width:600,"mask-closable":!1,title:t.isNew?"新增权限":"编辑权限",loading:t.loading},model:{value:t.showAddModal,callback:function(e){t.showAddModal=e},expression:"showAddModal"}},[e("Form",{ref:"ruleForm",staticStyle:{height:"150px"},attrs:{model:t.tradeInfo,"label-width":180,"label-colon":"",autocomplete:"off",rules:t.tradeValidRules}},[e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"管理用户",prop:"managerId"}},[e("Select",{staticStyle:{width:"260px"},attrs:{filterable:""},model:{value:t.tradeInfo.managerId,callback:function(e){t.$set(t.tradeInfo,"managerId",e)},expression:"tradeInfo.managerId"}},t._l(t.customerList,(function(a){return e("Option",{key:a.customerId,attrs:{value:a.customerId}},[t._v(" "+t._s(a.customerId+`(${a.customerName})`)+" ")])})),1)],1)],1),e("Col",{attrs:{span:18}},[e("FormItem",{attrs:{label:"交易员",prop:"traderIds"}},[e("Select",{staticStyle:{width:"260px"},attrs:{multiple:"",filterable:"","remote-method":t.remoteMethod3,loading:t.loading3,"max-tag-count":1},model:{value:t.tradeInfo.traderIds,callback:function(e){t.$set(t.tradeInfo,"traderIds",e)},expression:"tradeInfo.traderIds"}},t._l(t.customerList,(function(a){return e("Option",{key:a.customerId,attrs:{value:a.customerId}},[t._v(" "+t._s(a.customerId+`(${a.customerName})`)+" ")])})),1)],1)],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.ok(t.isNew)}}},[t._v("确定")])],1)],1)],1)],1),e("Table",{ref:"table",staticClass:"table-content",attrs:{columns:t.columns1,data:t.tableData,size:"small",height:t.tableHeight,border:""},on:{"on-sort-change":e=>t.handleSort(e,this.getTradeData)},scopedSlots:t._u([{key:"operator",fn:function({row:a}){return[e("div",{staticStyle:{display:"flex","justify-content":"flex-start"},on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"table-operate",on:{click:()=>t.modalUser("modify",a)}},[t._v(" 编辑 ")]),e("div",{staticClass:"table-operate",on:{click:()=>t.deleteRow(t.URL.tradeData,a.managerId,"管理员",t.getTradeData)}},[t._v(" 删除 ")])])]}}])}),[e("div",{staticClass:"page-bottom"},[e("Page",{attrs:{total:t.pagination.total,current:t.pagination.pageNumber,"page-size":t.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":e=>t.handleChangePage("pageSize",e,t.getTradeData),"on-change":e=>t.handleChangePage("pageNumber",e,t.getTradeData)}})],1)]],2)},o=[],r=a(4966),n=a(913),i=a(3072),l=a(928),d=a(4266),c={props:["userId"],mixins:[d.M],data(){let t=[{title:"管理员ID",key:"managerId",minWidth:80,resizable:!0,width:null,sortable:"custom"},{title:"管理员名称",key:"managerName",minWidth:80,resizable:!0,width:null,sortable:"custom"},{title:"交易员名称",key:"traders",minWidth:800,resizable:!0,width:null,render:this.renderTradeNames},{title:"操作",slot:"operator",width:null,minWidth:100}],e={managerName:""},a={managerId:[{required:!0,message:"请选择管理员代码"}],traderIds:[{required:!0,message:"请选择交易员"}]};return{loading3:!1,tradeValidRules:a,tradeInfo:{managerId:"",traderIds:[]},customerList:[],originalCustomerList:[],searchMgId:"",searchTdId:"",columns1:t,showAddModal:!1,isNew:!0,pagination:e}},mounted(){this.getTradeData(),this.getCustomerList()},methods:{handleExport:i.D9,handleSort:i.VB,remoteMethod3(t){""!==t&&(this.loading3=!0,setTimeout((()=>{this.loading3=!1}),200))},getCustomerList(){r.L.get(n.k.userList,(t=>{this.customerList=t.data,this.originalCustomerList=t.data}))},getTradeData(){this.loading=!0,r.L.post(`${n.k.tradeDataList}`,this.pagination,(t=>{setTimeout((()=>{this.loading=!1}),200),this.pagination.total=t.data.total,this.tableData=t.data.dataList||[]}))},modalUser(t,e){this.$refs.ruleForm.resetFields(),"new"===t?(this.remoteMethod3(),this.isNew=!0,this.showAddModal=!0,this.tradeInfo={managerId:"",traderIds:[]}):(this.isNew=!1,this.showAddModal=!0,this.tradeInfo={...e},this.tradeInfo.traderIds=e.traders.map((t=>t.traderId)))},ok(t){if(!this.tradeInfo.managerId)return void l.Message.error("请选择管理用户");if(!this.tradeInfo.traderIds.length)return void l.Message.error("请选择交易员");const e={method:t?"put":"post",msg:t?"新增成功":"修改成功",url:n.k.tradeData};r.L[e.method](e.url,{...this.tradeInfo,messageType:e.msg},(()=>{this.getTradeData(),this.cancel()}))},handleSearch(){this.getTradeData()},renderTradeNames(t,e){const a=e.row.traders.map((t=>t.traderName)).join(","),s=a.length>100?`${a.slice(0,100)}...`:a;return t("Tooltip",{attrs:{content:a,maxWidth:600},style:{whiteSpace:"nowrap"}},[s])}}},u=c,p=a(1656),m=(0,p.A)(u,s,o,!1,null,"f6426aae",null),h=m.exports}}]);