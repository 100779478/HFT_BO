"use strict";(self["webpackChunkbo_project"]=self["webpackChunkbo_project"]||[]).push([[123],{8094:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var s=function(){var e=this,t=e._self._c;return t("div",[t("Tabs",{staticStyle:{height:"49px"},attrs:{size:"default",value:e.activeTab,animated:!1},on:{"on-click":e.handleChangeTab}},[t("TabPane",{attrs:{name:"1",label:"做市策略",icon:"ios-calendar"}}),t("TabPane",{attrs:{name:"2",label:"量化策略",icon:"ios-hammer"}})],1),t(e.activeComponent,{tag:"component"})],1)},r=[],o=function(){var e=this,t=e._self._c;return t("div",[t("Row",{staticStyle:{margin:"0 3px 0 3px"}},[t("Col",[t("form",{staticClass:"top",attrs:{autocomplete:"off"}},[t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"策略名称"},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleName,callback:function(t){e.$set(e.pagination,"ruleName",t)},expression:"pagination.ruleName"}}),t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"用户代码"},on:{"on-change":e.handleSearch},model:{value:e.pagination.customerId,callback:function(t){e.$set(e.pagination,"customerId",t)},expression:"pagination.customerId"}}),t("Select",{staticClass:"mr3",staticStyle:{width:"auto"},attrs:{placeholder:"策略类型",clearable:!0},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleType,callback:function(t){e.$set(e.pagination,"ruleType",t)},expression:"pagination.ruleType"}},e._l(this.$store.state.dictionary.dictionaryList.RuleMakeMarketType,(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1),t("Select",{staticClass:"mr3",staticStyle:{width:"100px"},attrs:{placeholder:"状态",clearable:!0},on:{"on-change":e.handleSearch},model:{value:e.pagination.active,callback:function(t){e.$set(e.pagination,"active",t)},expression:"pagination.active"}},e._l(e.activeList,(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)]),t("Col",{staticClass:"mr3",staticStyle:{position:"absolute",right:"25px"}},[t("Button",{staticClass:"top",attrs:{type:"primary"},on:{click:e.handleSearch}},[t("Icon",{attrs:{type:"md-search"}}),e._v(" 查询 ")],1),t("Button",{staticClass:"top",attrs:{type:"info"},on:{click:function(t){return e.modalUser("new")}}},[t("Icon",{attrs:{type:"md-add"}}),e._v(" 新增策略 ")],1),t("Button",{staticClass:"top",attrs:{type:"success"},on:{click:()=>e.handleExport(e.URL.ruleExportMarket,this.pagination,"做市策略管理")}},[t("Icon",{attrs:{type:"md-download"}}),e._v(" 导出 ")],1),t("Modal",{attrs:{draggable:"",sticky:"",mask:"",width:600,"mask-closable":!1,title:e.isNew?"新增做市策略":"编辑做市策略"},model:{value:e.showAddModal,callback:function(t){e.showAddModal=t},expression:"showAddModal"}},[t("div",{staticClass:"modal__content"},[t("div",{staticClass:"modal__content-left"},[t("Form",{ref:"ruleForm",attrs:{model:e.userStrategyInfo,"label-width":210,"label-colon":"",rules:e.userValidRules,autocomplete:"off"}},[t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略文件类型",prop:"ruleFileType"}},[t("Select",{attrs:{placeholder:"请选择策略文件类型",disabled:"",maxlength:32},on:{"on-change":e.fetchNewPolicyInfo},model:{value:e.userStrategyInfo.ruleFileType,callback:function(t){e.$set(e.userStrategyInfo,"ruleFileType",t)},expression:"userStrategyInfo.ruleFileType"}},e._l(e.getRuleFileType(),(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略ID",prop:"ruleId"}},[t("Input",{attrs:{disabled:"",placeholder:"请输入策略ID",maxlength:20,"show-message":"false"},model:{value:e.userStrategyInfo.ruleId,callback:function(t){e.$set(e.userStrategyInfo,"ruleId",t)},expression:"userStrategyInfo.ruleId"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略文件存储位置",prop:"rulePath"}},[t("Tooltip",{staticStyle:{width:"100%"},attrs:{content:e.userStrategyInfo.rulePath,"max-width":"300"}},[t("Input",{attrs:{disabled:"",placeholder:"请输入策略文件存储位置",autocomplete:"off",maxlength:256},model:{value:e.userStrategyInfo.rulePath,callback:function(t){e.$set(e.userStrategyInfo,"rulePath",t)},expression:"userStrategyInfo.rulePath"}})],1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略版本",prop:"ruleVersion"}},[t("Input",{attrs:{placeholder:"请输入策略版本",autocomplete:"off",maxlength:32},model:{value:e.userStrategyInfo.ruleVersion,callback:function(t){e.$set(e.userStrategyInfo,"ruleVersion",t)},expression:"userStrategyInfo.ruleVersion"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略名称",prop:"ruleName"}},[t("Input",{attrs:{placeholder:"请输入策略名称",autocomplete:"off",maxlength:32},model:{value:e.userStrategyInfo.ruleName,callback:function(t){e.$set(e.userStrategyInfo,"ruleName",t)},expression:"userStrategyInfo.ruleName"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"用户代码",prop:"customerId"}},[t("Select",{attrs:{placeholder:"请选择用户代码",maxlength:32,disabled:!e.isNew,filterable:""},model:{value:e.userStrategyInfo.customerId,callback:function(t){e.$set(e.userStrategyInfo,"customerId",t)},expression:"userStrategyInfo.customerId"}},e._l(e.userList,(function(a){return t("Option",{key:a.customerId,attrs:{value:a.customerId}},[e._v(e._s(a.customerId)+" ")])})),1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略类型",prop:"ruleType"}},[t("Select",{attrs:{placeholder:"请选择策略类型",maxlength:32},on:{"on-change":e.handleShowParamsTable},model:{value:e.userStrategyInfo.ruleType,callback:function(t){e.$set(e.userStrategyInfo,"ruleType",t)},expression:"userStrategyInfo.ruleType"}},e._l(e.getRuleMakeMarketType(),(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)],1)],1)],1)]),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),t("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ok(e.isNew)}}},[e._v("确定")])],1)])],1)],1),t("Table",{ref:"table",staticClass:"table-content",attrs:{columns:e.columns1,data:e.tableData,height:e.tableHeight,size:"small",loading:e.loading,border:""},on:{"on-sort-change":t=>e.handleSort(t,this.getUserStrategyData)},scopedSlots:e._u([{key:"operator",fn:function({row:a}){return[t("div",{staticStyle:{display:"flex","justify-content":"flex-start"},on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"table-operate",on:{click:()=>e.modalUser("modify",a)}},[e._v(" 编辑 ")]),t("div",{staticClass:"table-operate",on:{click:()=>e.changeUserStatus(a)}},[e._v(" "+e._s(a.active?"禁用":"启用")+" ")]),t("Dropdown",{attrs:{trigger:"hover",transfer:""},on:{"on-click":function(t){return e.doOperate(t,a)}},scopedSlots:e._u([{key:"list",fn:function(){return[t("DropdownMenu",[t("DropdownItem",{staticStyle:{color:"#ed4014"},attrs:{name:"dele"}},[e._v("删除策略")])],1)]},proxy:!0}],null,!0)},[t("a",{staticStyle:{color:"#02aff1","font-size":"14px"}},[e._v(" "+e._s("更多")+" "),t("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1)]}}])}),[t("div",{staticClass:"page-bottom"},[t("Page",{attrs:{total:e.pagination.total,current:e.pagination.pageNumber,"page-size":e.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":t=>e.handleChangePage("pageSize",t,e.getUserStrategyData),"on-change":t=>e.handleChangePage("pageNumber",t,e.getUserStrategyData)}})],1)]],2)},l=[],n=a(4966),i=a(913),c=a(3072),u=a(4266),d=a(2138),p=a(6101),h={mixins:[u.M,d.b],data(){let e=[{title:"策略ID",key:"ruleId",minWidth:120,resizable:!0,sortable:"custom",width:null},{title:"策略文件类型",key:"ruleFileType",minWidth:140,resizable:!0,width:null,sortable:"custom",render:(e,{row:t})=>{const a=(0,c.$O)(t.ruleFileType,!0);return e("span",a.description)}},{title:"策略文件存储位置",key:"rulePath",sortable:"custom",resizable:!0,width:null,minWidth:220},{title:"策略版本",key:"ruleVersion",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略名称",key:"ruleName",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"用户代码",key:"customerId",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略类型",key:"ruleType",sortable:"custom",resizable:!0,width:null,minWidth:220,render:(e,{row:t})=>{const a=(0,c.Dq)(t.ruleType,!0);return e("span",a.description)}},{title:"策略状态",key:"active",resizable:!0,width:null,minWidth:120,sortable:"custom",render:(e,t)=>{const a=e("Icon",{props:{type:"ios-radio-button-on",color:"#19be6b"}}),s=e("Icon",{props:{type:"ios-radio-button-on",color:"#ed4014"}});return e("span",[t.row.active?a:s,t.row.active?"  已启用":"  已禁用"])}},{title:"操作",slot:"operator",width:180}],t={ruleName:"",ruleType:"",customerId:"",active:""};return{activeList:p._,fileName:"",columns1:e,pagination:t,userValidRules:{},showAddModal:!1,isNew:!0,selectedEnv:null}},mounted(){this.getUserStrategyData(),this.getUserList()},methods:{doOperate(e,t){switch(e){case"dele":this.deleteRow(i.k.rule,t.ruleId,"做市策略",this.getUserStrategyData);break;default:}},getUserStrategyData(){this.loading=!0,n.L.post(i.k.ruleListMarket,this.pagination,this.getUserResponse)},handleSearch(){this.pagination.pageNumber=1,this.getUserStrategyData()},modalUser(e,t){if(this.$refs.ruleForm.resetFields(),this.paramList=[],this.uploadFlag=!1,"new"===e){this.isNew=!0,this.showAddModal=!0;const e={id:"",ruleFileType:this.$store.state.dictionary.dictionaryList.RuleFileType[0].code,ruleId:"",rulePath:"",ruleVersion:"",ruleName:"",customerId:"",ruleType:"",active:!0,ruleParams:[]};Object.assign(this.userStrategyInfo,e),this.fetchNewPolicyInfo(this.userStrategyInfo.ruleFileType)}else this.isNew=!1,this.showAddModal=!0,Object.assign(this.userStrategyInfo,t)},ok(e){if(!this.userStrategyInfo.rulePath)return void this.$Message.warning("策略存储路径不能为空");const t={method:e?"put":"post",msg:e?"新增成功":"修改成功",url:i.k.ruleMarket};n.L[t.method](t.url,{...this.userStrategyInfo,messageType:t.msg},(e=>{"0"===e.code&&(this.getUserStrategyData(),this.cancel())}))},handleActiveEnable(e){"0"===e.code?(this.$Message.success("策略已启用"),this.getUserStrategyData()):this.$Message.error("启用失败："+e.msg)},handleActiveDisable(e){"0"===e.code?(this.$Message.success("策略已禁用"),this.getUserStrategyData()):this.$Message.error("禁用失败："+e.msg)},changeUserStatus(e){let t=e.ruleId;e.active?n.L.post(`${i.k.rule}/${t}/disable`,{},this.handleActiveDisable):n.L.post(`${i.k.rule}/${t}/enable`,{},this.handleActiveEnable)}}},m=h,g=a(1656),y=(0,g.A)(m,o,l,!1,null,"0b9e3378",null),f=y.exports,b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"quantify"},[t("div",{staticClass:"quantify-template"},[t("div",{staticClass:"quantify-title"},[e._v("策略模板")]),t("RuleTemplate")],1),t("div",{staticClass:"quantify-instance"},[t("div",{staticClass:"quantify-title",staticStyle:{"margin-top":"15px"}},[e._v("策略实例")]),t("RuleInstance")],1)])},I=[],v=function(){var e=this,t=e._self._c;return t("div",[t("Row",{staticStyle:{margin:"-5px 5px 5px 5px"},attrs:{justify:"space-between",align:"top"}},[t("Col",{staticStyle:{display:"flex","flex-wrap":"wrap","flex-basis":"calc(100% - 280px)"},attrs:{span:"14"}},[t("form",{attrs:{autocomplete:"off"}},[t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"策略名称"},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleName,callback:function(t){e.$set(e.pagination,"ruleName",t)},expression:"pagination.ruleName"}}),t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"用户代码"},on:{"on-change":e.handleSearch},model:{value:e.pagination.customerId,callback:function(t){e.$set(e.pagination,"customerId",t)},expression:"pagination.customerId"}}),t("Select",{staticClass:"mr3",staticStyle:{width:"100px"},attrs:{placeholder:"策略类型",clearable:!0},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleType,callback:function(t){e.$set(e.pagination,"ruleType",t)},expression:"pagination.ruleType"}},e._l(this.$store.state.dictionary.dictionaryList.RuleQuantType,(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1),t("Select",{staticClass:"mr3",staticStyle:{width:"100px"},attrs:{placeholder:"状态",clearable:!0},on:{"on-change":e.handleSearch},model:{value:e.pagination.active,callback:function(t){e.$set(e.pagination,"active",t)},expression:"pagination.active"}},e._l(e.activeList,(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)]),t("Col",{staticClass:"mr3",staticStyle:{"flex-shrink":"0"},attrs:{span:""}},[t("Button",{staticClass:"mr3",attrs:{type:"primary"},on:{click:e.handleSearch}},[t("Icon",{attrs:{type:"md-search"}}),e._v(" 查询 ")],1),t("Button",{staticClass:"mr3",attrs:{type:"info"},on:{click:function(t){return e.modalUser("new")}}},[t("Icon",{attrs:{type:"md-add"}}),e._v(" 新增策略 ")],1),t("Button",{staticClass:"mr3",attrs:{type:"success"},on:{click:()=>e.handleExport(e.URL.ruleExportQuant,this.pagination,"策略模板")}},[t("Icon",{attrs:{type:"md-download"}}),e._v(" 导出 ")],1)],1)],1),t("Modal",{attrs:{draggable:"",sticky:"",mask:"",width:e.chooseRule?1300:600,"mask-closable":!1,title:e.isNew?"新增策略模板":"编辑策略模板"},model:{value:e.showAddModal,callback:function(t){e.showAddModal=t},expression:"showAddModal"}},[t("div",{class:[e.chooseRule?"modal__content":""]},[t("div",{staticClass:"modal__content-left"},[t("Form",{ref:"ruleForm",attrs:{model:e.userStrategyInfo,"label-width":210,"label-colon":"",rules:e.userValidRules,autocomplete:"off"}},[t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略文件类型",prop:"ruleFileType"}},[t("Select",{attrs:{placeholder:"请选择策略文件类型",maxlength:32},on:{"on-change":e.fetchNewPolicyInfo},model:{value:e.userStrategyInfo.ruleFileType,callback:function(t){e.$set(e.userStrategyInfo,"ruleFileType",t)},expression:"userStrategyInfo.ruleFileType"}},e._l(e.getRuleFileType(),(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略ID",prop:"ruleId"}},[t("Input",{attrs:{disabled:"",placeholder:"请输入策略ID",maxlength:20,"show-message":"false"},model:{value:e.userStrategyInfo.ruleId,callback:function(t){e.$set(e.userStrategyInfo,"ruleId",t)},expression:"userStrategyInfo.ruleId"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略文件存储位置",prop:"rulePath"}},[t("Tooltip",{staticStyle:{width:"100%"},attrs:{content:e.userStrategyInfo.rulePath,"max-width":"300"}},[t("Input",{attrs:{placeholder:"请输入策略文件存储位置",autocomplete:"off",maxlength:256},model:{value:e.userStrategyInfo.rulePath,callback:function(t){e.$set(e.userStrategyInfo,"rulePath",t)},expression:"userStrategyInfo.rulePath"}})],1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略版本",prop:"ruleVersion"}},[t("Input",{attrs:{placeholder:"请输入策略版本",autocomplete:"off",maxlength:32},model:{value:e.userStrategyInfo.ruleVersion,callback:function(t){e.$set(e.userStrategyInfo,"ruleVersion",t)},expression:"userStrategyInfo.ruleVersion"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略名称",prop:"ruleName"}},[t("Input",{attrs:{placeholder:"请输入策略名称",autocomplete:"off",maxlength:32},model:{value:e.userStrategyInfo.ruleName,callback:function(t){e.$set(e.userStrategyInfo,"ruleName",t)},expression:"userStrategyInfo.ruleName"}})],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"用户代码",prop:"customerIds"}},[t("Select",{attrs:{placeholder:"请选择用户代码",maxlength:32,multiple:"",filterable:"","max-tag-count":1},model:{value:e.userStrategyInfo.customerIds,callback:function(t){e.$set(e.userStrategyInfo,"customerIds",t)},expression:"userStrategyInfo.customerIds"}},e._l(e.userList,(function(a){return t("Option",{key:a.customerId,attrs:{value:a.customerId}},[e._v(e._s(a.customerId+`(${a.customerName})`)+" ")])})),1)],1)],1),t("Col",{attrs:{span:18}},[t("FormItem",{attrs:{label:"策略类型",prop:"ruleType"}},[t("Select",{attrs:{placeholder:"请选择策略类型",maxlength:32},on:{"on-change":e.handleShowParamsTable},model:{value:e.userStrategyInfo.ruleType,callback:function(t){e.$set(e.userStrategyInfo,"ruleType",t)},expression:"userStrategyInfo.ruleType"}},e._l(e.getRuleQuantType(),(function(a){return t("Option",{key:a.code,attrs:{value:a.code}},[e._v(e._s(a.description)+" ")])})),1)],1)],1),t("Col",{attrs:{span:20}},[t("FormItem",{attrs:{label:""}},[t("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"fileInput"},on:{change:function(t){return e.handleFileChange(t,e.fileType,e.URL.ruleUploadQuant)}}}),t("Button",{directives:[{name:"show",rawName:"v-show",value:e.chooseRule,expression:"chooseRule"}],staticClass:"btn",staticStyle:{"margin-right":"5px"},attrs:{type:"success"},on:{click:function(t){return e.uploadFile("strategy")}}},[t("Icon",{attrs:{type:"md-cloud-upload"}}),e._v(" 上传策略文件 ")],1),t("Icon",{directives:[{name:"show",rawName:"v-show",value:e.uploadFlag,expression:"uploadFlag"}],attrs:{type:"ios-checkmark-circle",color:"green",size:"23"}}),t("div",[e._v(e._s(this.fileName))])],1)],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.chooseRule,expression:"chooseRule"}],staticClass:"modal__content-right"},[t("Button",{staticClass:"btn",attrs:{type:"info"},on:{click:function(t){return e.uploadFile("param")}}},[e._v("导入参数")]),t("Button",{staticClass:"btn",attrs:{type:"success"},on:{click:e.addRow}},[e._v("添加参数")]),t("Button",{staticClass:"btn",attrs:{type:"error"},on:{click:e.clearParamList}},[e._v("清空列表")]),t("Button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.exportParamList}},[e._v("导出参数")]),t("ParamsTable",{attrs:{paramList:e.paramList,readOnly:!1}})],1)]),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),t("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ok(e.isNew)}}},[e._v("确定")])],1)]),t("Table",{ref:"table",staticClass:"table-content",staticStyle:{clear:"both"},attrs:{columns:e.columns1,data:e.tableData,height:e.tableHeight,size:"small",loading:e.loading,border:"","highlight-row":""},on:{"on-sort-change":t=>e.handleSort(t,this.getUserStrategyData),"on-row-click":e.handleClickRow},scopedSlots:e._u([{key:"operator",fn:function({row:a}){return[t("div",{staticStyle:{display:"flex","justify-content":"flex-start"},on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"table-operate",on:{click:()=>e.modalUser("modify",a)}},[e._v(" 编辑 ")]),t("div",{staticClass:"table-operate",on:{click:()=>e.changeUserStatus(a)}},[e._v(" "+e._s(a.active?"禁用":"启用")+" ")]),t("Dropdown",{attrs:{trigger:"hover",transfer:""},on:{"on-click":function(t){return e.doOperate(t,a)}},scopedSlots:e._u([{key:"list",fn:function(){return[t("DropdownMenu",[t("DropdownItem",{attrs:{name:"param"}},[e._v("策略参数")]),t("DropdownItem",{directives:[{name:"show",rawName:"v-show",value:"8"===a.ruleType,expression:"row.ruleType==='8'"}],attrs:{name:"upload"}},[e._v("上传生产")]),t("DropdownItem",{staticStyle:{color:"#ed4014"},attrs:{name:"dele"}},[e._v("删除策略")])],1)]},proxy:!0}],null,!0)},[t("a",{staticStyle:{color:"#02aff1","font-size":"14px"}},[e._v(" "+e._s("更多")+" "),t("Icon",{attrs:{type:"ios-arrow-down"}})],1)])],1)]}}])}),[t("div",{staticClass:"page-bottom"},[t("Page",{attrs:{total:e.pagination.total,current:e.pagination.pageNumber,"page-size":e.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":t=>e.handleChangePage("pageSize",t,e.getUserStrategyData),"on-change":t=>e.handleChangePage("pageNumber",t,e.getUserStrategyData)}})],1)]],2)},S=[],w=a(34),k={components:{ParamsTable:w.A},mixins:[u.M,d.b],data(){let e=[{title:"策略ID",key:"ruleId",minWidth:95,resizable:!0,sortable:"custom",width:null},{title:"策略文件类型",key:"ruleFileType",minWidth:140,resizable:!0,width:null,sortable:"custom",render:(e,{row:t})=>{const a=(0,c.$O)(t.ruleFileType,!0);return e("span",a.description)}},{title:"策略文件存储位置",key:"rulePath",sortable:"custom",resizable:!0,width:null,minWidth:220},{title:"策略版本",key:"ruleVersion",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略名称",key:"ruleName",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"用户代码",key:"customers",resizable:!0,width:null,minWidth:220,render:(e,t)=>{const a=t.row.customers.map((e=>e.customerId)).join(","),s=a.length>100?`${a.slice(0,100)}...`:a;return e("Tooltip",{attrs:{content:a,maxWidth:600,transfer:!0},style:{whiteSpace:"nowrap"}},[s])}},{title:"策略类型",key:"ruleType",sortable:"custom",resizable:!0,width:null,minWidth:120,render:(e,{row:t})=>{const a=(0,c.Oq)(t.ruleType,!0);return e("span",a.description)}},{title:"策略状态",key:"active",resizable:!0,width:null,minWidth:95,sortable:"custom",render:(e,t)=>{const a=e("Icon",{props:{type:"ios-radio-button-on",color:"#19be6b"}}),s=e("Icon",{props:{type:"ios-radio-button-on",color:"#ed4014"}});return e("span",[t.row.active?a:s,t.row.active?"  已启用":"  已禁用"])}},{title:"操作",slot:"operator",width:180}],t={ruleName:"",ruleType:"",customerId:"",active:""},a={customerIds:[]};return{activeList:p._,fileName:"",columns1:e,pagination:t,showAddModal:!1,isNew:!0,selectedEnv:null,selectedRowId:null,userStrategyInfo:a}},mounted(){this.getUserStrategyData(),this.getUserList()},methods:{getRuleQuantType:c.Oq,handleClickRow(e){this.$store.commit("rule/setRuleId",e)},calculateTableHeight(){return.245*window.innerHeight},doOperate(e,t){switch(e){case"param":this.paramList=JSON.parse(JSON.stringify(t.ruleParams)),this.$Modal.info({render:e=>e(w.A,{props:{paramList:this.paramList,readOnly:!0}}),width:650,okText:"确认"});break;case"upload":this.handleUploadToProduct(t);break;case"dele":this.deleteRow(i.k.rule,t.ruleId,"量化策略",this.getUserStrategyData);break;default:}},handleUploadToProduct(e={}){const{ruleId:t}=e;n.L.get(i.k.envAllProduct,(e=>{const a=e.data;this.$Modal.confirm({render:e=>e("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},["上传策略至：",e("Select",{props:{placeholder:"请选择环境"},style:{width:"200px"},on:{change:e=>{this.selectedEnv=e}},model:{value:this.selectedEnv,callback:e=>{this.selectedEnv=e}}},a.map((t=>e("Option",{props:{value:t.id}},t.name))))]),onOk:()=>{const e={ruleId:t,productEnvId:this.selectedEnv,messageType:"上传成功"};n.L.post(i.k.ruleUploadProduct,e)},okText:"上传"})}))},getUserStrategyData(){this.loading=!0,n.L.post(i.k.ruleList,this.pagination,this.getUserResponse)},handleSearch(){this.pagination.pageNumber=1,this.getUserStrategyData()},modalUser(e,t){if(this.$refs.ruleForm.resetFields(),this.paramList=[],this.uploadFlag=!1,"new"===e){this.isNew=!0,this.showAddModal=!0;const e={ruleId:"",rulePath:"",ruleVersion:"",ruleName:"",customerIds:[],ruleType:"",ruleParams:[],active:!0};Object.assign(this.userStrategyInfo,e)}else this.chooseRule="8"===t.ruleType,this.isNew=!1,this.showAddModal=!0,this.paramList=JSON.parse(JSON.stringify(t.ruleParams)),this.paramList.forEach((e=>e.readOnly=String(e.readOnly))),this.userStrategyInfo.customerIds=t.customers.map((e=>e.customerId)),Object.assign(this.userStrategyInfo,t)},ok(e){const t=this.checkDuplicateNames(this.paramList);if(t.length>0){const e=t.map((({name:e,count:t})=>`${e} 有${t}条`)),a=`参数名重复：${e.join("、")}`;this.showMessage(a,"error",6)}else{if(this.userStrategyInfo.ruleParams=this.paramList,!this.userStrategyInfo.rulePath)return void this.$Message.error("策略文件存储位置不能为空");if(".so"!==this.userStrategyInfo.rulePath.slice(-3)&&"0"===this.userStrategyInfo.ruleFileType)return void this.$Message.error("策略文件类型为C++时，策略文件存储位置需要以.so结尾");if(this.userStrategyInfo.customerIds.length<=0)return void this.$Message.error("用户代码不能为空");const t={method:e?"put":"post",msg:e?"新增成功":"修改成功",url:i.k.ruleQuant};n.L[t.method](t.url,{...this.userStrategyInfo,messageType:t.msg},(e=>{"0"===e.code&&(this.getUserStrategyData(),this.cancel())}))}},handleActiveEnable(e){"0"===e.code?(this.$Message.success("策略已启用"),this.getUserStrategyData()):this.$Message.error("启用失败："+e.msg)},handleActiveDisable(e){"0"===e.code&&(this.$Message.success("策略已禁用"),this.getUserStrategyData())},changeUserStatus(e){let t=e.ruleId;console.log(1111,t),e.active?n.L.post(`${i.k.rule}/${t}/disable`,{},this.handleActiveDisable):n.L.post(`${i.k.rule}/${t}/enable`,{},this.handleActiveEnable)}}},x=k,_=(0,g.A)(x,v,S,!1,null,"7e84ad1c",null),C=_.exports,T=function(){var e=this,t=e._self._c;return t("div",[t("Row",{staticStyle:{margin:"-5px 5px 5px 5px"},attrs:{justify:"space-between",align:"top"}},[t("Col",{staticStyle:{display:"flex","flex-wrap":"wrap","flex-basis":"calc(100% - 180px)"},attrs:{span:"22"}},[t("form",{attrs:{autocomplete:"off"}},[t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"实例名称"},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleName,callback:function(t){e.$set(e.pagination,"ruleName",t)},expression:"pagination.ruleName"}}),t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"用户代码"},on:{"on-change":e.handleSearch},model:{value:e.pagination.customerId,callback:function(t){e.$set(e.pagination,"customerId",t)},expression:"pagination.customerId"}}),t("Input",{staticClass:"mr3",staticStyle:{width:"120px","border-radius":"20px"},attrs:{placeholder:"标签"},on:{"on-change":e.handleSearch},model:{value:e.pagination.ruleTag,callback:function(t){e.$set(e.pagination,"ruleTag",t)},expression:"pagination.ruleTag"}})],1)]),t("Col",{staticClass:"mr3",staticStyle:{"flex-shrink":"0"},attrs:{span:""}},[t("Button",{staticClass:"mr3",attrs:{type:"primary"},on:{click:e.handleSearch}},[t("Icon",{attrs:{type:"md-search"}}),e._v(" 查询 ")],1),t("Button",{staticClass:"mr3",attrs:{type:"success"},on:{click:()=>e.handleExport(e.URL.ruleExportInstance,this.pagination,"策略实例")}},[t("Icon",{attrs:{type:"md-download"}}),e._v(" 导出 ")],1)],1)],1),t("Table",{ref:"table",staticClass:"table-content",staticStyle:{clear:"both"},attrs:{columns:e.columns1,data:e.tableData,height:e.tableHeight,size:"small",loading:e.loading,border:""},on:{"on-sort-change":t=>e.handleSort(t,this.getUserStrategyData)}}),[t("div",{staticClass:"page-bottom"},[t("Page",{attrs:{total:e.pagination.total,current:e.pagination.pageNumber,"page-size":e.pagination.pageSize,"page-size-opts":[20,50,100,200],"show-sizer":"","show-total":""},on:{"on-page-size-change":t=>e.handleChangePage("pageSize",t,e.getUserStrategyData),"on-change":t=>e.handleChangePage("pageNumber",t,e.getUserStrategyData)}})],1)]],2)},N=[],$={components:{ParamsTable:w.A},mixins:[u.M,d.b],data(){let e=[{title:"策略实例ID",key:"ruleId",minWidth:120,resizable:!0,sortable:"custom",width:null},{title:"策略实例名称",key:"ruleName",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"用户代码",key:"customerId",sortable:"custom",resizable:!0,width:null,minWidth:120},{title:"策略标签",key:"ruleTag",sortable:"custom",resizable:!0,width:null,minWidth:120}],t={ruleName:"",ruleId:null,ruleTag:"",customerId:""};return{columns1:e,pagination:t,loading:!1,activeList:p._}},computed:{ruleId(){return this.$store.state.rule.ruleId}},watch:{ruleId(e,t){this.pagination.ruleId=e,this.getUserStrategyData()}},methods:{calculateTableHeight(){return.33*window.innerHeight},getUserStrategyData(){this.loading=!0,n.L.post(i.k.ruleQuantInstanceList,this.pagination,this.getUserResponse)},handleSearch(){this.pagination.pageNumber=1,this.getUserStrategyData()}}},D=$,M=(0,g.A)(D,T,N,!1,null,"2dc507ef",null),P=M.exports,U={name:"QuantifyManage",components:{RuleInstance:P,RuleTemplate:C}},F=U,z=(0,g.A)(F,b,I,!1,null,"092a73e4",null),L=z.exports,R={name:"RuleManage",components:{MarketManage:f,QuantifyManage:L},data(){return{activeTab:"1",activeComponent:"MarketManage"}},methods:{handleChangeTab(e){this.activeTab=e,this.setActiveComponent()},setActiveComponent(){const e=["MarketManage","QuantifyManage"];this.activeComponent=e[this.activeTab-1]}},mounted(){this.setActiveComponent()}},A=R,O=(0,g.A)(A,s,r,!1,null,"0806053e",null),W=O.exports},6101:function(e,t,a){a.d(t,{_:function(){return s}});const s=[{code:1,description:"已启用"},{code:0,description:"已禁用"}]}}]);